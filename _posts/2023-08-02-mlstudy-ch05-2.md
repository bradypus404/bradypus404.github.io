---
layout: post
title: "[ML Study]ch05-2 교차 검증과 그리드 서치"
subtitle: 
date: 2023-08-01 09:00:00 +0900
author: Jinha_k
categories: [Machine Learning]
tags: []
---

본 포스팅 내용은 [`혼자공부하는 머신러닝 딥러닝(박해선 저)`](https://product.kyobobook.co.kr/detail/S000001810330)를 함께 스터디하고 정리한 내용입니다.

## 검증 새트
테스트 새트를 사용하지 않고 과대적합인지 과소적합인지 판단하기 위해 훈련 세트를 나누어 검증하는 것을 말한다.

> 검증 세트를 몇 %만큼 나누어야 적당한가? <br> -> 보통 20~30%를 나누지만 훈련 세트가 많으면 많을 수록 더 적게 나누어도 문제가 발생하지 않는다.

### 교차 검증
검증 세트를 만들게 된다면 훈련에 사용되는 데이터가 줄어들게 된다. 하지만 대부분 데이터를 많이 훈련하면 좋은 모델이 만들어진다. 그러므로 교차검증을 이용하여 이러한 문제를 해결한다.

- 교차 검증: 검증 세트를 떼어 내어 평가하는 과정을 여러 번 반복한다.

![cross](/assets/images/post/2023-08-02-[5-2]/cross.png)

> k-폴드 교차 검증(k-fold cross validation)은 k부분으로 나눠서 교차 검증을 수행하는 것을 말합니다.

```python
sklearn.model_selection.cross_validate(estimator, X, y=None, *, groups=None, scoring=None, 
    cv=None, n_jobs=None, verbose=0, fit_params=None, pre_dispatch='2*n_jobs', return_train_score=False, 
    return_estimator=False, return_indices=False, error_score=nan)
```
[cross_validate 공식 문서]: https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_validate.html

```python
class sklearn.model_selection.StratifiedKFold(n_splits=5, *, shuffle=False, 
                                                random_state=None)
```
[StratifiedKFold 공식 문서]: https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html

## 하이퍼파라미터 튜닝
머신러닝 모델이 학습하는 파라미터를 **모델 파라미터**라고 부른다. 모델이 학습할 수 없어서 사용자가 지정해야만 하는 파라미터를 **하이퍼파라미터**라고 한다.

### 하이퍼파라미터 튜닝 방식
- 라이브러리가 제공하는 기본값을 그대로 사용해 모델을 훈련한다.
- 검증 세트의 정수나 교차 검증을 통해 매개변수를 조금씩 바꿔서 진행한다.

```python
class sklearn.model_selection.GridSearchCV(estimator, param_grid, *, scoring=None, n_jobs=None, refit=True, cv=None, verbose=0, pre_dispatch='2*n_jobs', error_score=nan, return_train_score=False)
```

[GridSearchCV 공식 문서]: https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html

### 랜덤 서치
만약 너무 많은 매개변수 조건이 있어서 그리드 서치 수행 시간이 오래걸릴 때 사용하는 방법은 **랜덤 서치(Random Search)**를 이용하면 된다.
**랜덤 서치**는 매개변수를 샐플링할 수 있는 확률 분포 객체를 전달한다.

#### 사용하는 클래스
```python
scipy.stats.randint = <scipy.stats._discrete_distns.randint_gen object>[source]
scipy.stats.uniform = <scipy.stats._continuous_distns.uniform_gen object>
```

[scipy randint 공식 문서]: https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.randint.html
[scipy uniform 공식 문서]: https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.uniform.html

```python
class sklearn.model_selection.RandomizedSearchCV(estimator, param_distributions, *, n_iter=10, scoring=None, n_jobs=None, refit=True, cv=None, verbose=0, pre_dispatch='2*n_jobs', random_state=None, error_score=nan, return_train_score=False)
```

[RandomizedSearchCV 공식 문서]: https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html

