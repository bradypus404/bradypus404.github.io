---
layout: post
title: "[ML Study]ch05-3 트리의 앙상블"
subtitle: 혼자 공부하는 머신러닝+딥러닝 [5-3]
date: 2023-08-01 09:03:00 +0900
author: Hyeonsu
categories: [Machine Learning]
tags: [앙상블 학습, 랜덤 포레스트, 엑스트라 트리, 그레이디언트 부스팅]
---

### 1. 정형 데이터와 비정형 데이터 
---------------------------

**정형 데이터**는 어떤 구조로 되어있다는 뜻이며, CSV나 데이터베이스, 엑셀 등에 저장하기 쉽다.
<br>**비정형 데이터**는 텍스트 데이터, 디지털 카메라로 찍은 사진 등 데이터베이스나 엑셀로 표현하기 어려운 것들이다.
<br>
정형 데이터를 다루는데 가장 뛰어난 성과를 내는 알고리즘은 **앙상블 학습(ensemble learning)**이다.

### 2. 랜덤 포레스트
---------------------------

**랜덤 포레스트(Random Forest)**는 대표적인 앙상블 학습이다.
<br>결정 트리를 랜덤하게 만들어 결정 트리(나무)의 숲을 만든다.
<br>각 결정 트리의 예측을 사용해 최종 예측을 만든다.

각 트리를 훈련하기 위한 데이터를 랜덤하게 만드는데,
<br>우리가 입력한 훈련 데이터에서 랜덤하게 샘플을 추출하여 훈련 데이터를 만든다.
<br>한 샘플이 중복되어 추출이 가능하다.

**부트스트랩 샘플(bootstrap sample)**은 중복된 샘플을 뽑을 수 있는 것으로,
<br>부트스트랩 샘플을 훈련 세트의 크기와 같게 만든다.
<br>1000개의 샘플 가방에서 중복하여 1000개의 샘플을 뽑는다.

분류 모델인 RandomForestClassifier는 기본적으로 전체 특성 개수의 제곱근만큼의 특성을 선택한다.
<br>회귀 모델인 RandomForestRegressor는 전체 특성을 사용한다.

랜덤 포레스트는 랜덤하게 선택한 샘플과 특성을 사용하기 때문에 훈련 세트에 과대적합되는 것을 막아준다.
<br>결정 트리의 앙상블이기 때문에 DecisionTreeClassifier가 제공하는 중요한 매개변수를 모두 제공한다.
<br>또한 **특성 중요도**는 각 결정 트리의 특성 중요도를 취합한 것이다.
<br>특성의 일부를 랜덤하게 선택하여 결정 트리를 훈련하기 때문에 하나의 특성에 과도하게 집중하지 않고 좀 더 많은 특성이 훈련에 기여할 기회를 얻는다.

부트스트랩 샘플에 포함되지 않고 남는 샘플을 OOB 샘플이라고 하는데,
<br>이것을 이용해 부트스트랩 샘플로 훈련한 결정 트리를 평가할 수 있다.


### 3. 엑스트라 트리
---------------------------

**엑스트라 트리(Extra Trees)**는 랜덤 포레스트와 매우 비슷하게 동작한다.
<br>랜덤 포레스트와의 차이점은 부트스트랩 샘플을 사용하지 않는다는 점이 있다.
<br> 각 결정 트리를 만들 때 전체 훈련 세트를 사용하고,대신 노드를 분할할 때 무작위로 분할한다.
<br> 성능이 낮아지겠지만 많은 트리를 앙상블하기 때문에 검증 세트의 점수를 높이는 효과를 가진다.

ExtraTreesClassifier로 교차 검증 점수를 확인하면 랜덤 포레스트와 비슷한 결과를 보여준다.
<br>랜덤하게 노드를 분할하기 때문에 빠른 계산 속도가 장점이다.
<br>엑스트라 트리의 회귀 버전은 ExtraTreesRegressor 클래스이다.


### 4. 그레이디언트 부스팅
---------------------------

**그레이디언트 부스팅(gradient boosting)**은 